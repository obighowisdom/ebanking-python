{% extends 'dashboard/base.html' %}
{% load static %}
{% block content %}

<style>
    body {
        background-color: #f8f9fa;
    }
    .profile-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: calc(100vh - 100px);
        padding: 30px 0;
    }
    .profile-card {
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.08);
        padding: 25px;
        width: 100%;
        max-width: 700px;
    }
    .profile-photo {
        display: block;
        width: 120px;
        height: 120px;
        border-radius: 50%;
        object-fit: cover;
        margin: 0 auto 10px;
        border: 3px solid #007bff;
    }
    h5 { font-weight: bold; }
    .form-control { border-radius: 8px; padding: 10px; }
    .btn-primary {
        border-radius: 8px;
        padding: 10px 20px;
        font-weight: bold;
        background-color: #007bff;
        border: none;
        transition: 0.3s ease;
    }
    .btn-primary:hover { background-color: #0056b3; }
    .section-title {
        font-weight: bold;
        font-size: 14px;
        text-transform: uppercase;
        margin-bottom: 10px;
        color: #555;
    }
    .horizontal { margin: 20px 0; }
</style>
<div style="display: flex; justify-content: center;">

    {% include 'dashboard/topNav.html' %}
</div>

<div class="profile-wrapper">
    <div class="card profile-card">
        <div class="card-body">
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{message.tags}}">{{message}}</div>
                {% endfor %}
            {% endif %}

            <h5 class="text-uppercase text-center mb-4">Profile Update</h5>

            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Profile Picture -->
                <div class="text-center mb-3">
                    {% if profile.profile_photo %}
                        <img src="{{ profile.profile_photo.url }}" class="profile-photo">
                    {% else %}
                        <img src="https://via.placeholder.com/120" class="profile-photo">
                    {% endif %}
                    {% if not profile.is_verified %}
                        <input type="file" name="profile_photo" class="form-control mt-2">
                    {% endif %}
                </div>

                <p class="section-title">User Information</p>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-control-label">Username</label>
                        <input class="form-control" type="text" value="{{ request.user.username }}" readonly>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-control-label">Email Address</label>
                        <input class="form-control" type="email" name="email" value="{{ request.user.email }}"
                            {% if profile.is_verified %}readonly{% endif %}>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-control-label">First Name</label>
                        <input class="form-control" type="text" name="first_name" required value="{{ request.user.first_name }}"
                            {% if profile.is_verified %}readonly{% endif %}>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-control-label">Last Name</label>
                        <input class="form-control" type="text" name="last_name" required value="{{ request.user.last_name }}"
                            {% if profile.is_verified %}readonly{% endif %}>
                    </div>
                </div>

                <hr class="horizontal dark">
                <p class="section-title">Contact Information</p>
                <div class="row">
                    <div class="col-md-12 mb-3">
                        <label class="form-control-label">Address</label>
                        <input class="form-control" type="text" name="address" required value="{{ profile.address }}"
                            {% if profile.is_verified %}readonly{% endif %}>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-control-label">City</label>
                        <input class="form-control" type="text" name="city" required value="{{ profile.city }}"
                            {% if profile.is_verified %}readonly{% endif %}>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-control-label">Country</label>
                        <input class="form-control" type="text" name="country" value="{{ profile.country }}"
                            {% if profile.is_verified %}readonly{% endif %}>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-control-label">Postal Code</label>
                        <input class="form-control" type="text" name="postal_code" required value="{{ profile.postal_code }}"
                            {% if profile.is_verified %}readonly{% endif %}>
                    </div>
                </div>

                

                {% if not profile.is_verified %}
                <div class="text-center">
                    <button type="submit" class="btn btn-primary px-4">Update Profile</button>
                </div>
                {% else %}
                <div class="alert alert-success text-center mt-3">
                    âœ… Your profile has been verified and locked.
                </div>
                {% endif %}
            </form>
        </div>
    </div>
</div>

{% endblock content %}
